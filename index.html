<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Nuri Restoran Men√º</title>
  <style>
    html,body { margin:0; padding:0; font-family: 'Segoe UI', Arial,sans-serif; background: #fafafa; scroll-behavior: smooth;}
    html, body {
      overflow-x: hidden;
      width: 100%;
      position: relative;
    }
    
    /* Loading Spinner */
    .loading-spinner {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      border: 5px solid #f3f3f3;
      border-top: 5px solid #00897b;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      z-index: 9999;
    }
    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    .menubar {
      background: #111211; color: #fff; font-weight: bold; font-size: 26px;
      text-align: center; letter-spacing: 2px; padding: 16px 0; margin-bottom: 0;
      position: sticky; top: 0; z-index: 100;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    .main { max-width:900px; margin:auto; padding-bottom: 60px;}
    .hosgeldin { text-align:center; margin: 23px 0 22px 0; font-size: 28px; color:#242525; font-weight:700; letter-spacing:1px;}
    
    /* Arama Kutusu */
    .search-container {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 12px;
    }
    .search-box {
      width: 100%;
      padding: 12px 20px 12px 45px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 25px;
      outline: none;
      transition: all 0.3s;
      background: white url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="gray" stroke-width="2"%3E%3Ccircle cx="11" cy="11" r="8"/%3E%3Cpath d="m21 21-4.35-4.35"/%3E%3C/svg%3E') no-repeat 15px center;
      box-sizing: border-box;
    }
    .search-box:focus {
      border-color: #00897b;
      box-shadow: 0 0 10px rgba(0,137,123,0.2);
    }
    
    /* Fiyat Filtresi */
    .price-filter {
      max-width: 900px;
      margin: 15px auto;
      padding: 0 12px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .price-btn {
      padding: 8px 16px;
      border: 2px solid #ddd;
      background: white;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
    }
    .price-btn:hover {
      border-color: #00897b;
      color: #00897b;
    }
    .price-btn.active {
      background: #00897b;
      color: white;
      border-color: #00897b;
    }
    
    .category-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px; margin:0 12px 22px 12px;
    }
    .cat-card {
      background:#fff; border-radius:18px; overflow:hidden; box-shadow:0 5px 18px rgba(0,0,0,0.15);
      aspect-ratio: 1.4/1; position:relative; cursor:pointer; 
      transition: all 0.3s ease;
      display: flex; align-items: stretch;
    }
    .cat-card:hover { 
      box-shadow:0 12px 24px rgba(0,137,123,0.3);
      transform: translateY(-5px);
    }
    .cat-card img {
      width:100%; height:100%; object-fit:cover; display:block;
      filter: brightness(0.7);
      transition: filter 0.3s;
    }
    .cat-card:hover img { filter: brightness(0.95);}
    .cat-title {
      position:absolute; left:0; right:0; top:0; bottom:0; display:flex; align-items:center; justify-content:center;
      font-size:2rem; color:#fff; font-weight: bold; text-align: center; letter-spacing:1px;
      text-shadow: 2px 2px 12px rgba(0,0,0,0.8);
      pointer-events: none;
      padding: 0 10px;
      text-transform: uppercase;
    }
    
    /* Pop√ºler Badge */
    .popular-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff6b6b;
      color: white;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.75em;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(255,107,107,0.4);
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .urun-listesi-wrap { padding: 0 0 16px 0; }
    .urunbar {
      background: #fff; padding: 10px 0; margin-bottom: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: flex; align-items: center; position: sticky; top:70px; z-index: 50;
    }
    .back-btn {
      background:none; border:none; font-size:22px; font-weight:bold; margin-right:7px; cursor:pointer; color:#222; padding-left:13px;
      transition: color 0.3s;
    }
    .back-btn:hover { color: #00897b; }
    .cat-head { font-size: 1.25em; font-weight: bold; letter-spacing: 0.7px;}
    .urunler { margin-top:6px;}
    .urun-row {
      background: #fff; border-radius:12px; margin: 12px 11px; box-shadow: 0 2px 13px rgba(0,0,0,0.08);
      display: flex; flex-direction: row; align-items: center; padding: 10px 7px 10px 0; gap:0;
      transition: all 0.3s;
      cursor: pointer;
    }
    .urun-row:hover {
      box-shadow: 0 5px 20px rgba(0,137,123,0.2);
      transform: translateY(-2px);
    }
    .urun-gorsel {
      width:70px; height:70px; border-radius: 9px; margin:0 15px 0 18px; object-fit: cover; background:#eee;
      border: 1px solid #e0e0e0;
      transition: transform 0.3s;
    }
    .urun-row:hover .urun-gorsel {
      transform: scale(1.1);
    }
    .urun-detay { flex:1; display:flex; flex-direction:column; align-items: flex-start; justify-content: center;}
    .urun-isim {
      font-size: 1.16em; font-weight: bold; color:#141824; letter-spacing: .5px;}
    .urun-aciklama { font-size:0.99em; color:#6a7682; margin: 4px 0 0 0;}
    .urun-fiyat { font-size:1.05em; font-weight:bold; color:#080808; margin-left:12px; white-space:nowrap;}
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      animation: fadeIn 0.3s;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .modal-content {
      background-color: #fefefe;
      margin: 5% auto;
      padding: 0;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 50px rgba(0,0,0,0.3);
      animation: slideIn 0.3s;
    }
    @keyframes slideIn {
      from { transform: translateY(-50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .modal-header {
      position: relative;
    }
    .modal-img {
      width: 100%;
      height: 250px;
      object-fit: cover;
      border-radius: 15px 15px 0 0;
    }
    .close {
      position: absolute;
      top: 10px;
      right: 15px;
      color: white;
      font-size: 35px;
      font-weight: bold;
      cursor: pointer;
      background: rgba(0,0,0,0.5);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s;
    }
    .close:hover { background: rgba(0,0,0,0.8); }
    .modal-body {
      padding: 20px;
    }
    .modal-title {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 10px;
      color: #141824;
    }
    .modal-desc {
      color: #6a7682;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .modal-price {
      font-size: 1.8em;
      font-weight: bold;
      color: #00897b;
    }
    
    /* Alt kategori butonlarƒ± */
    .subcategory-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin: 20px 12px;
      position: sticky;
      top: 135px;
      background: #fafafa;
      padding: 10px 0;
      z-index: 45;
    }
    .subcat-btn {
      background: linear-gradient(135deg, #121213 0%, #0d0217 100%);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 20px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .subcat-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    .subcat-btn.active-subcat {
      background: linear-gradient(135deg, #00897b 0%, #00695c 100%);
      box-shadow: 0 6px 20px rgba(0, 137, 123, 0.6);
    }
    
    /* Yukarƒ± √áƒ±k Butonu */
    .scroll-top-btn {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: #00897b;
      color: white;
      width: 45px;
      height: 50px;
      border-radius: 50%;
      border: none;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,137,123,0.4);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .scroll-top-btn.show {
      opacity: 1;
      visibility: visible;
    }
    .scroll-top-btn:hover {
      background: #00695c;
      transform: translateY(-5px);
      box-shadow: 0 6px 20px rgba(0,137,123,0.6);
    }
    
    .error-message {
      text-align: center;
      padding: 40px 20px;
      color: #ff6b6b;
      font-size: 18px;
    }
    
    @media(max-width:650px){
      .category-grid {grid-template-columns:1fr; gap:15px; margin:0 5px 15px 5px;}
      .hosgeldin { font-size:1.5em;}
      .menubar { font-size:23px; top: 0;}
      .urunbar { top: 60px; }
      .urun-row { margin: 8px 2vw;}
      .urun-gorsel { width:20vw; max-width:75px; height:20vw; max-height:75px; margin:0 6px 0 3vw;}
      .subcategory-buttons {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 10px;
        margin: 20px 12px;
        top: 135px;
      }
      .subcat-btn {
        padding: 15px 10px;
        font-size: 0.95em;
        letter-spacing: 0.5px;
      }
      .scroll-top-btn {
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
      }
      .modal-content {
        margin: 20% auto;
        width: 95%;
      }
      .price-filter {
        padding: 0 5px;
      }
      .price-btn {
        font-size: 0.85em;
        padding: 6px 12px;
      }
    }
  </style>
</head>
<body>
  <div class="loading-spinner" id="loadingSpinner"></div>
  <div class="menubar">Nuri Kuzeytepe Restaurant Men√º</div>
  
  <div class="main">
    <div id="menu-ana">
      <div class="hosgeldin">Ho≈ügeldiniz</div>
      
      <div class="search-container">
        <input type="text" id="globalSearch" class="search-box" placeholder="Men√ºde ara... (√∂rn: kebap, tavuk, rakƒ±)">
      </div>
      
      <div class="category-grid" id="category-grid"></div>
    </div>
    
    <div style="display:none" id="menu-cat">
      <div class="urun-listesi-wrap">
        <div class="urunbar">
          <button class="back-btn" onclick="geriDon()">‚Üê</button>
          <span class="cat-head" id="cat-head"></span>
        </div>
        
        <div class="price-filter" id="priceFilter" style="display:none;">
          <button class="price-btn" onclick="filterByPrice('all')">T√ºm√º</button>
          <button class="price-btn" onclick="filterByPrice(0, 200)">0-200‚Ç∫</button>
          <button class="price-btn" onclick="filterByPrice(200, 500)">200-500‚Ç∫</button>
          <button class="price-btn" onclick="filterByPrice(500, 1000)">500-1000‚Ç∫</button>
          <button class="price-btn" onclick="filterByPrice(1000, 5000)">1000‚Ç∫+</button>
        </div>
        
        <div class="search-container">
          <input type="text" id="productSearch" class="search-box" placeholder="Bu kategoride ara..." style="display:none;">
        </div>
        
        <div id="subcategory-container"></div>
        <div class="urunler" id="urun-listesi"></div>
      </div>
    </div>
  </div>
  
  <div id="productModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <img id="modalImg" class="modal-img" src="" alt="">
        <span class="close" onclick="closeModal()">&times;</span>
      </div>
      <div class="modal-body">
        <h2 class="modal-title" id="modalTitle"></h2>
        <p class="modal-desc" id="modalDesc"></p>
        <div class="modal-price" id="modalPrice"></div>
      </div>
    </div>
  </div>
  
  <button class="scroll-top-btn" id="scrollTopBtn" onclick="scrollToTop()">‚Üë</button>
  
  <script>
    let menudata, activeCat = null;
    let allProducts = [];
    let currentPriceFilter = 'all';
    
    async function menuyuGetir() {
      const loadingSpinner = document.getElementById('loadingSpinner');
      const categoryGrid = document.getElementById('category-grid');
      
      try {
        const res = await fetch("menu.json"); 
        
        if (!res.ok) {
          throw new Error(`HTTP error! status: ${res.status}`);
        }
        
        menudata = await res.json();
        
        menudata.categories.forEach(cat => {
          if (cat.products) {
            cat.products.forEach(p => allProducts.push({...p, category: cat.name}));
          }
          if (cat.subcategories) {
            cat.subcategories.forEach(sub => {
              if (sub.products) {
                sub.products.forEach(p => allProducts.push({...p, category: cat.name, subcategory: sub.name}));
              }
            });
          }
        });
        
        kategorileriGoster(menudata.categories);
        loadingSpinner.style.display = 'none';
      } catch (error) {
        console.error('Men√º y√ºklenirken hata:', error);
        loadingSpinner.style.display = 'none';
        categoryGrid.innerHTML = `
          <div class="error-message" style="grid-column: 1/-1;">
            <h3>Men√º y√ºklenirken bir hata olu≈ütu</h3>
            <p>L√ºtfen sayfayƒ± yenileyin veya daha sonra tekrar deneyin.</p>
            <p style="font-size: 14px; color: #999;">Hata: ${error.message}</p>
          </div>`;
      }
    }
    
    function kategorileriGoster(kategoriler) {
      let html = "";
      const popularItems = ['Sƒ±caklar', 'ƒ∞√ßkiler'];
      
      kategoriler.forEach((kat, i) => {
        const isPopular = popularItems.includes(kat.name);
        html += `<div class="cat-card" onclick="kategoriTikla(${i})">
          <img src="${kat.image}" alt="${kat.name}" loading="lazy">
          ${isPopular ? '<div class="popular-badge">üî• Pop√ºler</div>' : ''}
          <div class="cat-title">${kat.name}</div>
        </div>`;
      });
      document.getElementById("category-grid").innerHTML = html;
    }
    
    function kategoriTikla(index) {
      activeCat = menudata.categories[index]; 
      currentPriceFilter = 'all';
      
      history.pushState({page: 'category', index: index}, '', '');
      
      document.getElementById("menu-ana").style.display = "none";
      document.getElementById("menu-cat").style.display = "";
      document.getElementById("cat-head").innerText = activeCat.name;
      document.getElementById("productSearch").style.display = "block";
      document.getElementById("productSearch").value = "";
      
      if (activeCat.products || activeCat.subcategories) {
        document.getElementById("priceFilter").style.display = "flex";
      }
      
      if (activeCat.subcategories && activeCat.subcategories.length > 0) {
        altKategorileriGoster(activeCat.subcategories);
        altKategoriTikla(0);
      } else if (activeCat.products) {
        document.getElementById("subcategory-container").innerHTML = "";
        urunleriGoster(activeCat.products);
      }
      
      window.scrollTo(0, 0);
    }
    
    function altKategorileriGoster(subcategories) {
      let html = '<div class="subcategory-buttons">';
      subcategories.forEach((subcat, i) => {
        html += `<button class="subcat-btn ${i === 0 ? 'active-subcat' : ''}" id="subcat-${i}" onclick="altKategoriTikla(${i})">${subcat.name}</button>`;
      });
      html += '</div>';
      document.getElementById("subcategory-container").innerHTML = html;
    }
    
    function altKategoriTikla(subIndex) {
      document.querySelectorAll('.subcat-btn').forEach((btn, i) => {
        btn.classList.toggle('active-subcat', i === subIndex);
      });
      
      const subcat = activeCat.subcategories[subIndex];
      if (subcat.products) {
        urunleriGoster(subcat.products);
        document.getElementById("cat-head").innerText = `${activeCat.name} - ${subcat.name}`;
      }
    }
    
    function urunleriGoster(urunler) {
      let html = "";
      urunler.forEach((urun) => {
        const fiyatHTML = urun.price 
          ? `<div class="urun-fiyat">${urun.price.toLocaleString("tr-TR")} ‚Ç∫</div>` 
          : "";
        
        const urunJSON = JSON.stringify(urun).replace(/'/g, "&#39;").replace(/"/g, "&quot;");
        
        html += `<div class="urun-row" onclick='openModal(${urunJSON})'>
          <img src="${urun.image}" class="urun-gorsel" alt="${urun.name}" loading="lazy" onerror="this.src='https://via.placeholder.com/70x70?text=Resim+Yok'">
          <div class="urun-detay">
            <div class="urun-isim">${urun.name}</div>
            <div class="urun-aciklama">${urun.desc || ""}</div>
          </div>
          ${fiyatHTML}
        </div>`;
      });
      document.getElementById("urun-listesi").innerHTML = html;
    }
    
    function openModal(urun) {
      document.getElementById('modalImg').src = urun.image;
      document.getElementById('modalTitle').innerText = urun.name;
      document.getElementById('modalDesc').innerText = urun.desc || 'Detaylƒ± a√ßƒ±klama bulunmamaktadƒ±r.';
      document.getElementById('modalPrice').innerText = urun.price ? `${urun.price.toLocaleString("tr-TR")} ‚Ç∫` : 'Fiyat bilgisi yok';
      document.getElementById('productModal').style.display = 'block';
    }
    
    function closeModal() {
      document.getElementById('productModal').style.display = 'none';
    }
    
    window.onclick = function(event) {
      const modal = document.getElementById('productModal');
      if (event.target == modal) {
        closeModal();
      }
    }
    
    function filterByPrice(min, max) {
      currentPriceFilter = min === 'all' ? 'all' : {min, max};
      
      document.querySelectorAll('.price-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      let products = activeCat.products || [];
      if (activeCat.subcategories) {
        const activeSubcat = document.querySelector('.subcat-btn.active-subcat');
        if (activeSubcat) {
          const subIndex = parseInt(activeSubcat.id.split('-')[1]);
          products = activeCat.subcategories[subIndex].products || [];
        }
      }
      
      if (min === 'all') {
        urunleriGoster(products);
      } else {
        const filtered = products.filter(p => p.price >= min && p.price < max);
        urunleriGoster(filtered);
      }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      const productSearch = document.getElementById('productSearch');
      productSearch.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();
        const rows = document.querySelectorAll('.urun-row');
        
        rows.forEach(row => {
          const name = row.querySelector('.urun-isim').textContent.toLowerCase();
          const desc = row.querySelector('.urun-aciklama').textContent.toLowerCase();
          
          if (name.includes(query) || desc.includes(query)) {
            row.style.display = 'flex';
          } else {
            row.style.display = 'none';
          }
        });
      });
      
      const globalSearch = document.getElementById('globalSearch');
      globalSearch.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();
        
        if (query.length < 2) {
          kategorileriGoster(menudata.categories);
          return;
        }
        
        const filtered = allProducts.filter(p => 
          p.name.toLowerCase().includes(query) || 
          (p.desc && p.desc.toLowerCase().includes(query))
        );
        
        if (filtered.length > 0) {
          let html = `<div style="padding: 20px; background: white; margin: 10px 12px; border-radius: 12px;">
            <h3 style="margin-top:0;">${filtered.length} sonu√ß bulundu</h3>
          </div>`;
          
          filtered.forEach(urun => {
            const fiyatHTML = urun.price ? `<div class="urun-fiyat">${urun.price.toLocaleString("tr-TR")} ‚Ç∫</div>` : "";
            const urunJSON = JSON.stringify(urun).replace(/'/g, "&#39;").replace(/"/g, "&quot;");
            
            html += `<div class="urun-row" onclick='openModal(${urunJSON})'>
              <img src="${urun.image}" class="urun-gorsel" alt="${urun.name}" loading="lazy" onerror="this.src='https://via.placeholder.com/70x70?text=Resim+Yok'">
              <div class="urun-detay">
                <div class="urun-isim">${urun.name}</div>
                <div class="urun-aciklama">${urun.category}${urun.subcategory ? ' - ' + urun.subcategory : ''}</div>
              </div>
              ${fiyatHTML}
            </div>`;
          });
          
          document.getElementById('category-grid').innerHTML = html;
        } else {
          document.getElementById('category-grid').innerHTML = `
            <div style="padding: 40px; text-align: center; grid-column: 1/-1;">
              <h3>Sonu√ß bulunamadƒ±</h3>
              <p>Farklƒ± bir kelime deneyin</p>
            </div>`;
        }
      });
    });
    
    function geriDon() {
      if (window.history.state && window.history.state.page === 'category') {
        history.back();
      }
      
      document.getElementById("menu-cat").style.display = "none";
      document.getElementById("menu-ana").style.display = "";
      document.getElementById("subcategory-container").innerHTML = "";
      document.getElementById("urun-listesi").innerHTML = "";
      document.getElementById("priceFilter").style.display = "none";
      document.getElementById("productSearch").style.display = "none";
      document.getElementById("globalSearch").value = "";
      kategorileriGoster(menudata.categories);
      activeCat = null;
      window.scrollTo(0,0);
    }
    
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    window.addEventListener('scroll', function() {
      const btn = document.getElementById('scrollTopBtn');
      if (window.pageYOffset > 300) {
        btn.classList.add('show');
      } else {
        btn.classList.remove('show');
      }
    });
    
    window.addEventListener('popstate', function(event) {
      if (document.getElementById("menu-cat").style.display !== "none") {
        event.preventDefault();
        geriDon();
      }
    });
    
    window.addEventListener('load', function() {
      history.pushState({page: 'menu'}, '', '');
    });
    
    menuyuGetir();
  </script>
</body>
</html>